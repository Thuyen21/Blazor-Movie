@page "/AdminAccountManagement"
@attribute [Authorize(Roles = "Admin")]
@*<input placeholder="Enter your text" @bind-value="@searchString" />

	<button class="btn btn-primary" @onclick="Search">Search</button>

	@if (accs == null)
	{
	<p>
	<em>Loading...</em>
	</p>
	}
	else
	{
	<table class="table">
	<thead>
	<tr>
	<th>Id</th>
	<th><button class="btn btn-primary" @onclick="EmailSortParm">Email</button></th>
	<th><button class="btn btn-primary" @onclick="NameSortParm">Name</button></th>
	<th>Role</th>
	<th><button class="btn btn-primary" @onclick="DateSortParm">Date Of Birth</button></th>
	<th>Wallet</th>
	<th></th>
	<th></th>
	</tr>
	</thead>
	<tbody>
	@foreach (var acc in accs)
	{
	<tr>
	<td>@acc.Id</td>
	<td>@acc.Email</td>
	<td>@acc.Name</td>
	<td>@acc.Role</td>
	<td>@acc.DateOfBirth.ToShortDateString()</td>
	<td>@acc.Wallet</td>
	@{
	var linkEdit = $"EditAccount/{acc.Id}"; var linkBan = $"BanAccount/{acc.Id}";
	}
	<td><NavLink class="nav-link" href="@linkEdit">Edit</NavLink></td>
	<td><NavLink class="nav-link" href="@linkBan">Ban</NavLink> </td>
	</tr>
	}
	</tbody>
	</table>
	<button @onclick="LoadMore">Click to load more</button>

	}*@

<head>
	<meta charset="UTF-8">
	<!-- Boxicons CDN Link -->
	<link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<style>
	@Css
</style>

<body>
	<section class="home-section">
		<nav>
			<div class="sidebar-button">
				<span class="dashboard">Dashboard</span>
			</div>
			<div class="search-box" style="margin-right:20%">
				<input type="text" placeholder="Search..." @bind="@searchString">
				<i class='bx bx-search' @onclick="Search"></i>
			</div>
			@*<div></div><div></div>*@
		</nav>
		<div class="home-content">
			<div class="overview-boxes">
				<div class="box">
					<div class="right-side">
						<div class="box-topic">Total Order</div>
						<div class="number">40,876</div>
						<div class="indicator">
							<i class='bx bx-up-arrow-alt'></i>
							<span class="text">Up from yesterday</span>
						</div>
					</div>
					<i class='bx bx-cart-alt cart'></i>
				</div>
				<div class="box">
					<div class="right-side">
						<div class="box-topic">Total Sales</div>
						<div class="number">38,876</div>
						<div class="indicator">
							<i class='bx bx-up-arrow-alt'></i>
							<span class="text">Up from yesterday</span>
						</div>
					</div>
					<i class='bx bxs-cart-add cart two'></i>
				</div>
				<div class="box">
					<div class="right-side">
						<div class="box-topic">Total Profit</div>
						<div class="number">$12,876</div>
						<div class="indicator">
							<i class='bx bx-up-arrow-alt'></i>
							<span class="text">Up from yesterday</span>
						</div>
					</div>
					<i class='bx bx-cart cart three'></i>
				</div>
				<div class="box">
					<div class="right-side">
						<div class="box-topic">Total Return</div>
						<div class="number">11,086</div>
						<div class="indicator">
							<i class='bx bx-down-arrow-alt down'></i>
							<span class="text">Down From Today</span>
						</div>
					</div>
					<i class='bx bxs-cart-download cart four'></i>
				</div>
			</div>
		</div>
		@if (accs == null)
		{
			<p>
				<em>Loading...</em>
			</p>
		}
		else
		{
			<div class="home-content">
				<div class="sales-boxes">
					<div class="recent-sales box">
						<div class="title">Account manager</div>
						<div class="sales-details">
							<ul class="details">
								<div class="button" style="margin:10px" @onclick="EmailSortParm">
									<a style="cursor: pointer;">Sort by Email</a>
								</div>
							</ul>
							<ul class="details">
								<div class="button" style="margin:10px" @onclick="EmailSortParm">
									<a style="cursor: pointer;">Sort by Name</a>
								</div>
							</ul>
							<ul class="details">
								<div class="button" style="margin:10px" @onclick="DateSortParm">
									<a style="cursor: pointer;">Sort by DoB</a>
								</div>
							</ul>
						</div>
						
						
						<div class="sales-details">
							<ul class="details">
								<li class="topic">ID</li>
								@foreach (var acc in accs)
								{
									<li style="overflow: hidden; text-overflow: ellipsis; max-width: 150px; margin-right: 10px;"><a href="#">@acc.Id</a></li>
								}

							</ul>
							<ul class="details">
								<li class="topic" @onclick="EmailSortParm"><i class='bx bx-mail-send'></i> Email</li>
								@foreach (var acc in accs)
								{
									<li style="overflow: hidden; text-overflow: ellipsis; max-width: 200px; margin-right: 10px;"><a href="#">@acc.Email</a></li>
								}
							</ul>
							<ul class="details">
								<li class="topic"><i class='bx bx-user'></i> Name</li>
								@foreach (var acc in accs)
								{
									<li style="overflow: hidden; text-overflow: ellipsis; max-width: 200px; margin-right: 10px;"><a href="#">@acc.Name</a></li>
								}
							</ul>
							<ul class="details">
								<li class="topic"><i class='bx bx-network-chart'></i> Role</li>
								@foreach (var acc in accs)
								{
									<li style="overflow: hidden; text-overflow: ellipsis; max-width: 100px; margin-right: 10px;"><a href="#">@acc.Role</a></li>
								}
							</ul>
							<ul class="details">
								<li class="topic"><i class='bx bx-calendar'></i> DOB</li>
								@foreach (var acc in accs)
								{
									<li style="overflow: hidden; text-overflow: ellipsis; max-width: 150px; margin-right: 10px;"><a href="#">@acc.DateOfBirth.ToShortDateString()</a></li>
								}
							</ul>
							<ul class="details">
								<li class="topic"><i class='bx bx-wallet'></i> Wallet</li>
								@foreach (var acc in accs)
								{
									<li style="overflow: hidden; text-overflow: ellipsis; max-width: 150px; margin-right: 10px;"><a href="#">@acc.Wallet</a></li>
								}

							</ul>
							<ul class="details">
								<li class="topic"><i class='bx bxs-traffic-cone'></i> Action</li>
								@foreach (var acc in accs)
								{
									<li>
										@{
											var linkEdit = $"EditAccount/{acc.Id}"; var linkBan = $"BanAccount/{acc.Id}";
										}
										<div class="button">
											<a href="@linkEdit" style="margin-right:5px">Edit</a>
											<a href="@linkBan" style="margin-left:5px">Ban</a>
										</div>
									</li>
								}
							</ul>
						</div>
						<div class="button" style="margin:10px" @onclick="LoadMore">
							<a style="cursor: pointer;">Load More</a>
						</div>
					</div>
				</div>
			</div>
		}@* Here is end else*@

	</section>

</body>

@code{
	[Parameter]
        public List<AccountManagementModel> accs { get; set; } = new();
        protected int index = 0;
        protected string? searchString { get; set; }
        protected bool isSearch = false;

        protected string sort = null;

        protected async Task NameSortParm()
        {
            index = 0;
            sort = sort == "name" ? "nameDesc" : "name";
            accs = await _httpClient.GetFromJsonAsync<List<AccountManagementModel>>($"Admin/AccountManagement/ /{sort}/{index}");
            isSearch = false;
            searchString = null;




        }

        protected async Task DateSortParm()
        {
            index = 0;
            sort = sort == "date" ? "dateDesc" : "date";
            accs = await _httpClient.GetFromJsonAsync<List<AccountManagementModel>>($"Admin/AccountManagement/ /{sort}/{index}");
            isSearch = false;
            searchString = null;



        }

        protected async Task EmailSortParm()
        {
            index = 0;
            sort = sort == "email" ? "emailDesc" : "email";
            accs = await _httpClient.GetFromJsonAsync<List<AccountManagementModel>>($"Admin/AccountManagement/ /{sort}/{index}");
            isSearch = false;
            searchString = null;



        }
        protected async Task Search()
        {
            index = 0;
            if (searchString != null)
            {
                accs = await _httpClient.GetFromJsonAsync<List<AccountManagementModel>>($"admin/AccountManagement/{searchString}/ /{index}");
                isSearch = true;
            }
            else
            {
                accs = await _httpClient.GetFromJsonAsync<List<AccountManagementModel>>($"admin/AccountManagement/ / /{index}");
                isSearch = false;
            }


            sort = null;
        }
        protected override async Task OnInitializedAsync()
        {
            accs = await _httpClient.GetFromJsonAsync<List<AccountManagementModel>>($"admin/AccountManagement/ / /{index}");

        }
        protected async Task LoadMore()
        {
            index++;
            if (isSearch)
            {
                accs.AddRange(await _httpClient.GetFromJsonAsync<List<AccountManagementModel>>($"admin/AccountManagement/{searchString}//{index}"));
            }
            else if (sort != null)
            {
                accs.AddRange(await _httpClient.GetFromJsonAsync<List<AccountManagementModel>>($"admin/AccountManagement/ /{sort}/{index}"));
            }
            else
            {
                accs.AddRange(await _httpClient.GetFromJsonAsync<List<AccountManagementModel>>($"admin/AccountManagement/ / /{index}"));
            }

        }

		protected string? Css = "/* Googlefont Poppins CDN Link */ * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; } .home-section { position: relative; background: #fff; min-height: 100vh; width: calc(100% - 240px); /*left: 20%; right: 20%;*/ /*top: 10%;*/ transition: all 0.5s ease; } .sidebar.active ~ .home-section { width: calc(100% - 60px); left: 60px; } .home-section nav { display: flex; justify-content: space-between; height: 80px; background: #fff; display: flex; align-items: center; position: fixed; width: calc(100% - 240px); /*left: 240px;*/ z-index: 100; padding: 0 20px; box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1); transition: all 0.5s ease; } /*.sidebar.active ~ .home-section nav { left: 60px; width: calc(100% - 60px); }*/ .home-section nav .sidebar-button { display: flex; align-items: center; font-size: 24px; font-weight: 500; } nav .sidebar-button i { font-size: 35px; margin-right: 10px; } .home-section nav .search-box { position: relative; height: 50px; max-width: 550px; width: 100%; margin: 0 20px; } nav .search-box input { height: 100%; width: 100%; outline: none; background: #F5F6FA; border: 2px solid #EFEEF1; border-radius: 6px; font-size: 18px; padding: 0 15px; } nav .search-box .bx-search { position: absolute; height: 40px; width: 40px; background: #2697FF; right: 5px; top: 50%; transform: translateY(-50%); border-radius: 4px; line-height: 40px; text-align: center; color: #fff; font-size: 22px; transition: all 0.4 ease; } .home-section nav .profile-details { display: flex; align-items: center; background: #F5F6FA; border: 2px solid #EFEEF1; border-radius: 6px; height: 50px; min-width: 190px; padding: 0 15px 0 2px; } .home-section .home-content { position: relative; padding-top: 104px; } .home-content .overview-boxes { display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; padding: 0 20px; margin-bottom: 26px; } .overview-boxes .box { display: flex; align-items: center; justify-content: center; width: calc(100% / 4 - 15px); background: #fff; padding: 15px 14px; border-radius: 12px; box-shadow: 0 5px 10px rgba(0,0,0,0.1); height: 140px; width: 200px; } .overview-boxes .box-topic { font-size: 20px; font-weight: 500; align-content: center; } .home-content .box .number { display: inline-block; font-size: 35px; margin-top: -6px; font-weight: 500; } .home-content .box .indicator { display: flex; align-items: center; } .home-content .box .indicator i { height: 20px; width: 20px; background: #8FDACB; line-height: 20px; text-align: center; border-radius: 50%; color: #fff; font-size: 20px; margin-right: 5px; } .box .indicator i.down { background: #e87d88; } .home-content .box .indicator .text { font-size: 12px; } .home-content .box .cart { display: inline-block; font-size: 32px; height: 50px; width: 50px; background: #cce5ff; line-height: 50px; text-align: center; color: #66b0ff; border-radius: 12px; margin: -15px 0 0 6px; } .home-content .box .cart.two { color: #2BD47D; background: #C0F2D8; } .home-content .box .cart.three { color: #ffc233; background: #ffe8b3; } .home-content .box .cart.four { color: #e05260; background: #f7d4d7; } .home-content .total-order { font-size: 20px; font-weight: 500; } .home-content .sales-boxes { display: flex; justify-content: space-between; /* padding: 0 20px; */ } /* left box */ .home-content .sales-boxes .recent-sales { width: 200%; background: #fff; padding: 20px 30px; margin: 0 20px; border-radius: 12px; box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1); } .home-content .sales-boxes .sales-details { display: flex; align-items: center; justify-content: space-between; } .sales-boxes .box .title { font-size: 24px; font-weight: 500; /* margin-bottom: 10px; */ } .sales-boxes .sales-details li.topic { margin:auto; font-size: 20px; font-weight: 500; max-width: 200px; overflow: hidden; text-overflow: ellipsis; -webkit-line-clamp: 1; -webkit-box-orient: vertical; display: -webkit-box; } .sales-boxes .sales-details li { list-style: none; margin: 8px 0; } .sales-boxes .sales-details li a { font-size: 18px; color: #333; font-size: 400; text-decoration: none; } .sales-boxes .box .button { width: 100%; display: flex; justify-content: flex-end; } .sales-boxes .box .button a { color: #fff; background: #3e2093; padding: 4px 12px; font-size: 15px; font-weight: 400; border-radius: 4px; text-decoration: none; transition: all 0.3s ease; } .sales-boxes .box .button a:hover { background: #0d3073; } /* Right box */ .home-content .sales-boxes .top-sales { width: 35%; background: #fff; padding: 20px 30px; margin: 0 20px 0 0; border-radius: 12px; box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1); } .sales-boxes .top-sales li { display: flex; align-items: center; justify-content: space-between; margin: 10px 0; } .sales-boxes .top-sales li a img { height: 40px; width: 40px; object-fit: cover; border-radius: 12px; margin-right: 10px; background: #333; } .sales-boxes .top-sales li a { display: flex; align-items: center; text-decoration: none; } .sales-boxes .top-sales li .product, .price { font-size: 17px; font-weight: 400; color: #333; } /* Responsive Media Query */ @media (max-width: 1240px) { .home-section { width: calc(100% - 60px); left: 60px; } .home-section nav { width: calc(100% - 60px); left: 60px; } } @media (max-width: 1150px) { .home-content .sales-boxes { flex-direction: column; } .home-content .sales-boxes .box { width: 100%; overflow-x: scroll; margin-bottom: 30px; } .home-content .sales-boxes .top-sales { margin: 0; } } @media (max-width: 1000px) { .overview-boxes .box { width: calc(100% / 2 - 15px); margin-bottom: 15px; } } @media (max-width: 700px) { nav .sidebar-button .dashboard, nav .profile-details .admin_name, nav .profile-details i { display: none; } .home-section nav .profile-details { height: 50px; min-width: 40px; } .home-content .sales-boxes .sales-details { width: 560px; } } @media (max-width: 550px) { .overview-boxes .box { width: 100%; margin-bottom: 15px; } .sidebar.active ~ .home-section nav .profile-details { display: none; } }";
}